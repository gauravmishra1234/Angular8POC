var ScrollHeightListener = /** @class */ (function () {
    function ScrollHeightListener(directive, state) {
        this.directive = directive;
        this.state = state;
        this.DEFAULT_REQUEST_TIMEOUT = 30000;
    }
    ScrollHeightListener.prototype.start = function () {
        var _this = this;
        this.listener = window.requestAnimationFrame(this.listen.bind(this));
        if (!this.httpRequestTimeout) {
            this.httpRequestTimeout = setTimeout(function () {
                _this.stopIfRequestTimeout();
            }, this.DEFAULT_REQUEST_TIMEOUT);
        }
    };
    ScrollHeightListener.prototype.stop = function () {
        window.cancelAnimationFrame(this.listener);
        clearTimeout(this.httpRequestTimeout);
        this.httpRequestTimeout = null;
    };
    ScrollHeightListener.prototype.listen = function () {
        if (this.state.previousScrollHeight !== this.state.scrollHeight) {
            this.stop();
            this.directive.onScrollbarHeightChanged();
        }
        else {
            this.start();
        }
    };
    ScrollHeightListener.prototype.stopIfRequestTimeout = function () {
        if (!this.state.previousScrollPositionpUpdated) {
            this.stop();
        }
    };
    return ScrollHeightListener;
}());
export { ScrollHeightListener };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Nyb2xsLWhlaWdodC1saXN0ZW5lci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1pbmZpbml0ZS1zY3JvbGxlci8iLCJzb3VyY2VzIjpbInNyYy9hcHAvc2Nyb2xsLWhlaWdodC1saXN0ZW5lci9zY3JvbGwtaGVpZ2h0LWxpc3RlbmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBO0lBUUUsOEJBQ1UsU0FBdUMsRUFDdkMsS0FBNEI7UUFENUIsY0FBUyxHQUFULFNBQVMsQ0FBOEI7UUFDdkMsVUFBSyxHQUFMLEtBQUssQ0FBdUI7UUFSOUIsNEJBQXVCLEdBQUcsS0FBSyxDQUFDO0lBU3BDLENBQUM7SUFFRSxvQ0FBSyxHQUFaO1FBQUEsaUJBV0M7UUFWQyxJQUFJLENBQUMsUUFBUSxHQUFHLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBRXJFLElBQUksQ0FBQyxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDNUIsSUFBSSxDQUFDLGtCQUFrQixHQUFHLFVBQVUsQ0FDbEM7Z0JBQ0UsS0FBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7WUFDOUIsQ0FBQyxFQUNELElBQUksQ0FBQyx1QkFBdUIsQ0FDN0IsQ0FBQztTQUNIO0lBQ0gsQ0FBQztJQUVNLG1DQUFJLEdBQVg7UUFDRSxNQUFNLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzNDLFlBQVksQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztRQUN0QyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDO0lBQ2pDLENBQUM7SUFFTyxxQ0FBTSxHQUFkO1FBQ0UsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLG9CQUFvQixLQUFLLElBQUksQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFFO1lBQy9ELElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUNaLElBQUksQ0FBQyxTQUFTLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztTQUMzQzthQUFNO1lBQ0wsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO1NBQ2Q7SUFDSCxDQUFDO0lBRU8sbURBQW9CLEdBQTVCO1FBQ0UsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsOEJBQThCLEVBQUU7WUFDOUMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1NBQ2I7SUFDSCxDQUFDO0lBQ0gsMkJBQUM7QUFBRCxDQUFDLEFBOUNELElBOENDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmd4SW5maW5pdGVTY3JvbGxlckRpcmVjdGl2ZSB9IGZyb20gJy4uL25neC1pbmZpbml0ZS1zY3JvbGxlci5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgRGlyZWN0aXZlU3RhdGVTZXJ2aWNlIH0gZnJvbSAnLi4vZGlyZWN0aXZlLXN0YXRlLnNlcnZpY2UnO1xuXG5leHBvcnQgY2xhc3MgU2Nyb2xsSGVpZ2h0TGlzdGVuZXIge1xuXG4gIHByaXZhdGUgREVGQVVMVF9SRVFVRVNUX1RJTUVPVVQgPSAzMDAwMDtcblxuICBwcml2YXRlIGxpc3RlbmVyOiBudW1iZXI7XG5cbiAgcHJpdmF0ZSBodHRwUmVxdWVzdFRpbWVvdXQ6IGFueTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGRpcmVjdGl2ZTogTmd4SW5maW5pdGVTY3JvbGxlckRpcmVjdGl2ZSxcbiAgICBwcml2YXRlIHN0YXRlOiBEaXJlY3RpdmVTdGF0ZVNlcnZpY2VcbiAgKSB7IH1cblxuICBwdWJsaWMgc3RhcnQoKTogdm9pZCB7XG4gICAgdGhpcy5saXN0ZW5lciA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5saXN0ZW4uYmluZCh0aGlzKSk7XG5cbiAgICBpZiAoIXRoaXMuaHR0cFJlcXVlc3RUaW1lb3V0KSB7XG4gICAgICB0aGlzLmh0dHBSZXF1ZXN0VGltZW91dCA9IHNldFRpbWVvdXQoXG4gICAgICAgICgpID0+IHtcbiAgICAgICAgICB0aGlzLnN0b3BJZlJlcXVlc3RUaW1lb3V0KCk7XG4gICAgICAgIH0sXG4gICAgICAgIHRoaXMuREVGQVVMVF9SRVFVRVNUX1RJTUVPVVRcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHN0b3AoKTogdm9pZCB7XG4gICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMubGlzdGVuZXIpO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLmh0dHBSZXF1ZXN0VGltZW91dCk7XG4gICAgdGhpcy5odHRwUmVxdWVzdFRpbWVvdXQgPSBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBsaXN0ZW4oKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuc3RhdGUucHJldmlvdXNTY3JvbGxIZWlnaHQgIT09IHRoaXMuc3RhdGUuc2Nyb2xsSGVpZ2h0KSB7XG4gICAgICB0aGlzLnN0b3AoKTtcbiAgICAgIHRoaXMuZGlyZWN0aXZlLm9uU2Nyb2xsYmFySGVpZ2h0Q2hhbmdlZCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdG9wSWZSZXF1ZXN0VGltZW91dCgpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuc3RhdGUucHJldmlvdXNTY3JvbGxQb3NpdGlvbnBVcGRhdGVkKSB7XG4gICAgICB0aGlzLnN0b3AoKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==